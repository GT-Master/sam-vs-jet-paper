#! /bin/csh -f
#
# c-shell script to download selected files from <server_name> using curl
# NOTE: if you want to run under a different shell, make sure you change
#       the 'set' commands according to your shell's syntax
# after you save the file, don't forget to make it executable
#   i.e. - "chmod 755 <name_of_script>"
#
# you can add cURL options here (progress bars, etc.)
set opts = ""
#
# Replace "xxxxxx" with your password
# IMPORTANT NOTE:  If your password uses a special character that has special meaning
#                  to csh, you should escape it with a backslash
#                  Example:  set passwd = "my\!password"
set passwd = 'letneilin'
set num_chars = `echo "$passwd" |awk '{print length($0)}'`
@ num = 1
set newpass = ""
while ($num <= $num_chars)
  set c = `echo "$passwd" |cut -b{$num}-{$num}`
  if ("$c" == "&") then
    set c = "%26";
  else
    if ("$c" == "?") then
      set c = "%3F"
    else
      if ("$c" == "=") then
        set c = "%3D"
      endif
    endif
  endif
  set newpass = "$newpass$c"
  @ num ++
end
set passwd = "$newpass"
#
if ("$passwd" == "xxxxxx") then
  echo "You need to set your password before you can continue"
  echo "  see the documentation in the script"
  exit
endif
#
# authenticate - NOTE: You should only execute this command ONE TIME.
# Executing this command for every data file you download may cause
# your download privileges to be suspended.
curl -o /dev/null -k -s -c auth.rda.ucar.edu.$$ -d "email=ncswart@uvic.ca&passwd=$passwd&action=login" https://rda.ucar.edu/cgi-bin/login
#
# download the file(s)
# NOTE:  if you get 403 Forbidden errors when downloading the data files, check
#        the contents of the file 'auth_status.rda.ucar.edu'
curl $opts -k -b auth.rda.ucar.edu.$$ -r 0-15346,30695-46132,61559-76984,92369-107724,123003-138313,153610-168925,184209-199534,214787-230134,245441-260819,276125-291442,306741-322140,337447-352842,368154-383501,398802-414256,429701-445120,460476-475864,491192-506506,521762-537099,552368-567722,583063-598437,613768-629101,644440-659774,675058-690467,705836-721202,736573-752008,767419-782862,798298-813681,829041-844368,859659-874954,890187-905510,920791-936160,951475-966894,982260-997608,1012878-1028216,1043508-1058935,1074345-1089763,1105134-1120605,1136027-1151601,1167054-1182519,1197840-1213274,1228616-1243959,1259242-1274635,1289951-1305378,1320703-1336147,1351492-1366931,1382276-1397682,1413016-1428538,1443960-1459465,1474880-1490473,1505957-1521526,1537026-1552527,1567941-1583388,1598721-1614092,1629360-1644712,1659993-1675425,1690749-1706140,1721458-1736885,1752217-1767678,1783016-1798500,1813929-1829478,1844905-1860459,1875929-1891542,1907095-1922559,1937890-1953386,1968767-1984136,1999416-2014848,2030173-2045620,2060930-2076359,2091695-2107090,2122360-2137806,2153126-2168664,2184063-2199572,2215007-2230520,2245962-2261486,2276910-2292406,2307835-2323206,2338530-2353862,2369105-2384489,2399783-2415198,2430549-2446003,2461315-2476752,2492098-2507602,2522976-2538325,2553627-2569096,2584554-2600119,2615588-2631170,2646610-2662104,2677479-2692892,2708218-2723600,2738951-2754347,2769638-2785064,2800369-2815782,2831134-2846541,2861856-2877320,2892658-2908155,2923589-2939093,2954546-2970108,2985594-3001129,3016596-3032063,3047469-3062912,3078280-3093628,3108934-3124358,3139700-3155115,3170481-3185903,3201211-3216671,3232040-3247529,3262940-3278455,3293842-3309328,3324760-3340287,3355724-3371322,3386816-3402319,3417731-3433119,3448381-3463806,3479124-3494502,3509835-3525273,3540593-3555973,3571235-3586682,3602027-3617449,3632763-3648272,3663679-3679181,3694611-3710165,3725598-3741219,3756714-3772198,3787572-3802957,3818238-3833543,3848775-3864126,3879434-3894860,3910189-3925607,3940863-3956265,3971588-3987066,4002370-4017874,4033280-4048761,4064152-4079718,4095177-4110770,4126331-4141845,4157249-4172657,4187973-4203346,4218640-4234067,4249370-4264786,4280118-4295577,4310939-4326320,4341619-4357066,4372413-4387864,4403246-4418716,4434066-4449594,4465045-4480652,4496111-4511554,4526967-4542373,4557735-4573114,4588427-4603805,4619149-4634506,4649814-4665138,4680453-4695874,4711218-4726654,4741963-4757538,4773028-4788648,4804163-4819661,4835113-4850669,4866139-4881631,4897077-4912474,4927801-4943091,4958350-4973679,4988973-5004374,5019693-5035091,5050377-5065803,5081131-5096563,5111940-5127386,5142777-5158261,5173666-5189234,5204679-5220224,5235707-5251117,5266431-5281873,5297186-5312537,5327782-5343166,5358471-5373948,5389343-5404735,5420043-5435461,5450755-5466204,5481537-5497048,5512464-5527917,5543321-5558794,5574234-5589769,5605238-5620708,5636077-5651457,5666744-5682031,5697281-5712689,5728018-5743451,5758821-5774241,5789570-5804992,5820350-5835801,5851154-5866628,5882035-5897492,5912947-5928454,5943879-5959419,5974843-5990260,6005605-6020978,6036331-6051638,6066918-6082275,6097611-6113056,6128409-6143764,6159071-6174430,6189710-6205151,6220518-6236020,6251445-6266910,6282295-6297762,6313156-6328622,6344013-6359392,6374650-6390038,6405313-6420620,6435876-6451216,6466504-6481899,6497176-6512559,6527825-6543247,6558616-6574066,6589424-6604885,6620309-6635747,6651083-6666602,6682020-6697589,6713093-6728577,6743955-6759359,6774639-6789916,6805169-6820530,6835812-6851208,6866539-6881987,6897296-6912793,6928179-6943603,6958960-6974429,6989782-7005234,7020570-7036100,7051539-7067170,7082708-7098220,7113631-7129069,7144436-7159713,7174959-7190361,7205733-7221165,7236519-7251940,7267253-7282722,7298026-7313468,7328827-7344379,7359799-7375304,7390750-7406296,7421726-7437318,7452822-7468309,7483683-7499023,7514314-7529633,7544936-7560296,7575571-7590970,7606252-7621610,7636854-7652226,7667529-7682959,7698244-7713699,7729084-7744600,7759950-7775428,7790836-7806432,7821842-7837311,7852675-7868037,7883329-7898638,7913873-7929271,7944537-7959881,7975181-7990539,8005877-8021251,8036536-8051996,8067337-8082790,8098208-8113699,8129090-8144511,8159864-8175317,8190734-8206137,8221448-8236734,8251990-8267252,8282511-8297850,8313185-8328549,8343865-8359304,8374576-8389990,8405347-8420798,8436121-8451629,8466985-8482401,8497722-8513177,8528555-8544081,8559543-8574945,8590257-8605567,8620802-8636131,8651454-8666835,8682101-8697541,8712842-8728245,8743520-8758954,8774262-8789676,8804984-8820443,8835823-8851239,8866568-8882107,8897538-8913096,8928549-8943978,8959298-8974647,8989894-9005215,9020485-9035888,9051189-9066641,9081963-9097368,9112646-9128031,9143274-9158699,9174019-9189483,9204806-9220288,9235644-9251121,9266529-9282036,9297461-9312877,9328226-9343650,9358967-9374349,9389658-9405033,9420300-9435712,9450971-9466336,9481649-9497062,9512319-9527735,9543047-9558546,9573914-9589375,9604789-9620250,9635608-9651146,9666635-9682054,9697396-9712772,9728051-9743372,9758617-9774008,9789351-9804691,9819991-9835427,9850715-9866175,9881493-9896891,9912218-9927632,9943002-9958504,9973887-9989377,10004754-10020296,10035714-10051188,10066520-10081932,10097266-10112523,10127757-10143110,10158398-10173779,10189101-10204577,10219949-10235420,10250807-10266220,10281566-10296981,10312352-10327846,10343240-10358784,10374197-10389689,10405074-10420522,10435890-10451331,10466626-10482009,10497323-10512659,10527992-10543452,10558832-10574204,10589485-10604954,10620330-10635833,10651194-10666723,10682166-10697665,10713055-10728554,10743956-10759497,10774889-10790343,10805687-10821021,10836234-10851555,10866823-10882244,10897568-10912987,10928324-10943702,10958985-10974442,10989732-11005188,11020473-11035883,11051230-11066687,11082073-11097573,11112935-11128440,11143860-11159307,11174666-11190069,11205358-11220741,11236013-11251357,11266650-11282093,11297381-11312829,11328121-11343586,11358940-11374438,11389814-11405312,11420781-11436236 http://rda.ucar.edu/data/ds093.2/timeseries/pgbl01.gdas.WND.10m.grb2 -o pgbl01.gdas.WND.10m.grb2.subset
#
# clean up
rm auth.rda.ucar.edu.$$ auth_status.rda.ucar.edu

